<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nekotexs | –î–∞—à–±–æ—Ä–¥</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Firebase Imports (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –º–æ–¥—É–ª—å–Ω—ã–µ, v11.6.1) -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, onSnapshot, setDoc, setLogLevel, collection, query, updateDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        
        // --- –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï CANVAS (–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏) ---
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : null;
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
        
        // --- –ü–ï–†–ï–ú–ï–ù–ù–´–ï –°–û–°–¢–û–Ø–ù–ò–Ø ---
        let db;
        let auth;
        let userId = null;
        let isAuthReady = false;

        const AVATAR_SEEDS = [
            'Neko', 'Kitsune', 'Panda', 'Robot', 'Designer', 'Adventurer', 'Milo', 'Luna', 'Lily', 'Shadow',
            'Pixel', 'Voxel', 'Bot', 'Star', 'Moon' 
        ];

        // --- –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ò –ê–£–¢–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–Ø ---

        if (firebaseConfig) {
            setLogLevel('Debug'); // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
            const app = initializeApp(firebaseConfig);
            db = getFirestore(app);
            auth = getAuth(app);

            // 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏: –∂–¥–µ–º, –ø–æ–∫–∞ Firebase –æ–ø—Ä–µ–¥–µ–ª–∏—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            onAuthStateChanged(auth, async (user) => {
                let current_user = user;

                if (!current_user) {
                    try {
                        // –ü–æ–ø—ã—Ç–∫–∞ –≤—Ö–æ–¥–∞ —Å —Ç–æ–∫–µ–Ω–æ–º Canvas –∏–ª–∏ –∞–Ω–æ–Ω–∏–º–Ω—ã–π –≤—Ö–æ–¥
                        if (initialAuthToken) {
                            const result = await signInWithCustomToken(auth, initialAuthToken);
                            current_user = result.user;
                        } else {
                            const result = await signInAnonymously(auth);
                            current_user = result.user;
                        }
                    } catch (error) {
                        console.error("Auth error:", error);
                        // –ï—Å–ª–∏ –≤—Ö–æ–¥ –Ω–µ —É–¥–∞–ª—Å—è, –º—ã –≤—Å–µ —Ä–∞–≤–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º, –Ω–æ userId –±—É–¥–µ—Ç null –∏–ª–∏ –∞–Ω–æ–Ω–∏–º–Ω—ã–º
                        current_user = auth.currentUser; 
                    }
                }
                
                if (current_user) {
                    userId = current_user.uid;
                } else {
                    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ ID, –µ—Å–ª–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–µ —É–¥–∞–ª–∞—Å—å
                    userId = crypto.randomUUID(); 
                }
                
                isAuthReady = true;
                console.log(`Authenticated User ID (Final): ${userId}`);
                
                // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –ø–æ–ª–Ω—ã–π ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ Canvas)
                document.getElementById('userIdDisplay').textContent = `ID: ${userId}`;
                document.getElementById('walletDisplay').textContent = userId.substring(0, 6) + '...' + userId.substring(userId.length - 4);

                initializeDashboard(userId);
            });
        }
        
        // --- –û–°–ù–û–í–ù–ê–Ø –õ–û–ì–ò–ö–ê –î–ê–®–ë–û–†–î–ê (–ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –¢–û–õ–¨–ö–û –ø–æ—Å–ª–µ Auth) ---

        function initializeDashboard(uid) {
            if (!db || !uid) return;

            // –ü–†–ò–í–ê–¢–ù–´–ô –ü–£–¢–¨: /artifacts/{appId}/users/{userId}/data/profile
            const userProfileDocRef = doc(db, "artifacts", appId, "users", uid, "data", "profile");
            // –ü–£–ë–õ–ò–ß–ù–´–ô –ü–£–¢–¨: /artifacts/{appId}/public/data/transactions
            const transactionsCollectionRef = collection(db, "artifacts", appId, "public", "data", "transactions");

            // 1. –°–ª—É—à–∞—Ç–µ–ª—å –ü—Ä–æ—Ñ–∏–ª—è (–ë–∞–ª–∞–Ω—Å, –ò–º—è, –ê–≤–∞—Ç–∞—Ä, –ú–µ—Ç—Ä–∏–∫–∏)
            onSnapshot(userProfileDocRef, (docSnap) => {
                const defaultProfile = { 
                    name: "–¢—Ä–µ–π–¥–µ—Ä", 
                    avatarSeed: "Neko", 
                    balance: 0,
                    totalMined: 0,
                    totalWithdrawn: 0,
                    totalDonated: 0
                };
                
                let profile = defaultProfile;

                if (docSnap.exists()) {
                    profile = { ...defaultProfile, ...docSnap.data() };
                } else {
                    // –ï—Å–ª–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –Ω–µ—Ç, —Å–æ–∑–¥–∞–µ–º –µ–≥–æ —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                    setDoc(userProfileDocRef, defaultProfile).catch(e => console.error("Error setting default profile:", e));
                }
                
                updateProfileUI(profile, uid);
                
            }, (error) => {
                console.error("Error reading profile data:", error);
            });

            // 2. –°–ª—É—à–∞—Ç–µ–ª—å –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (–§–∏–ª—å—Ç—Ä—É–µ–º –ø–æ –∫–æ—à–µ–ª—å–∫—É/userId –≤ –ø–∞–º—è—Ç–∏, —Ç–∞–∫ –∫–∞–∫ Firestore-–ø—Ä–∞–≤–∏–ª–∞ –º–æ–≥—É—Ç –Ω–µ —Ä–∞–∑—Ä–µ—à–∏—Ç—å complex queries)
            const txQuery = query(transactionsCollectionRef); 
            
            onSnapshot(txQuery, (snapshot) => {
                let userTransactions = [];
                snapshot.forEach(doc => {
                    const data = doc.data();
                    // –§–∏–ª—å—Ç—Ä—É–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—â–∏–µ —Ç–µ–∫—É—â–µ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
                    if (data.wallet === uid || data.userId === uid) { 
                        userTransactions.push({ id: doc.id, ...data });
                    }
                });
                
                // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ timestamp (–≤ –ø–∞–º—è—Ç–∏)
                userTransactions.sort((a, b) => (b.timestamp?.seconds || 0) - (a.timestamp?.seconds || 0));
                
                updateTransactionsUI(userTransactions.slice(0, 5)); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º 5 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö
            }, (error) => {
                console.error("Error reading transactions:", error);
                document.getElementById('transactionsList').innerHTML = '<p class="text-red-400 text-xs text-center p-4">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π.</p>';
            });
        }

        // --- –û–ë–ù–û–í–õ–ï–ù–ò–ï –ò–ù–¢–ï–†–§–ï–ô–°–ê ---

        function updateProfileUI(profile, uid) {
            document.getElementById('userNameDisplay').textContent = profile.name || "–¢—Ä–µ–π–¥–µ—Ä";
            document.getElementById('balanceDisplay').textContent = (profile.balance || 0).toFixed(4);
            document.getElementById('totalMinedDisplay').textContent = (profile.totalMined || 0).toFixed(4);
            document.getElementById('totalWithdrawnDisplay').textContent = (profile.totalWithdrawn || 0).toFixed(4);
            document.getElementById('totalDonatedDisplay').textContent = (profile.totalDonated || 0).toFixed(4);
            
            const avatarSeed = profile.avatarSeed || "Neko";
            document.getElementById('avatarImg').src = `https://api.dicebear.com/7.x/identicon/svg?seed=${avatarSeed}`;
            document.getElementById('profileNameInput').value = profile.name || '';
            
            // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –∞–≤–∞—Ç–∞—Ä–∞ –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ
            document.querySelectorAll('.avatar-option').forEach(img => {
                img.classList.remove('selected');
                if (img.dataset.seed === avatarSeed) {
                    img.classList.add('selected');
                }
            });
        }

        function updateTransactionsUI(transactions) {
            const list = document.getElementById('transactionsList');
            list.innerHTML = ''; 

            if (transactions.length === 0) {
                list.innerHTML = '<p class="text-gray-500 text-xs text-center p-2">–ù–µ—Ç –Ω–µ–¥–∞–≤–Ω–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π.</p>';
                return;
            }

            transactions.forEach(tx => {
                const isDeposit = tx.type === 'DEPOSIT' || (tx.amount && tx.amount > 0);
                const typeText = isDeposit ? '–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ' : '–í—ã–≤–æ–¥';
                const sign = isDeposit ? '+' : (tx.amount && tx.amount < 0) ? '' : '-';
                const amount = Math.abs(tx.amount || 0).toFixed(4);
                const colorClass = isDeposit ? 'text-green-400' : 'text-red-400';
                
                let dateStr = "–ù/–î";
                if (tx.timestamp && tx.timestamp.seconds) {
                    dateStr = new Date(tx.timestamp.seconds * 1000).toLocaleString('ru-RU', { 
                        day: '2-digit', month: 'short', hour: '2-digit', minute: '2-digit' 
                    });
                } 

                const txElement = `
                    <div class="flex justify-between items-center text-xs p-2 bg-black/30 rounded">
                        <span class="text-gray-400">${dateStr}</span>
                        <span class="${colorClass} font-bold">${sign}${amount} NEKO</span>
                        <span class="text-gray-500">${typeText}</span>
                    </div>
                `;
                list.innerHTML += txElement;
            });
        }
        
        // --- –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –ú–û–î–ê–õ–¨–ù–û–ì–û –û–ö–ù–ê –ü–†–û–§–ò–õ–Ø ---
        
        window.initializeAvatarSelector = function() {
            const selector = document.getElementById('avatarSelector');
            selector.innerHTML = ''; 
            
            AVATAR_SEEDS.forEach(seed => {
                const img = document.createElement('img');
                img.src = `https://api.dicebear.com/7.x/identicon/svg?seed=${seed}`;
                img.alt = `${seed} –ê–≤–∞—Ç–∞—Ä`;
                img.className = 'avatar-option rounded-full transition duration-150 ease-in-out';
                img.dataset.seed = seed;
                
                img.onclick = () => {
                    document.querySelectorAll('.avatar-option').forEach(el => el.classList.remove('selected'));
                    img.classList.add('selected');
                };
                selector.appendChild(img);
            });
        }
        
        window.openProfileModal = function() {
            if (!isAuthReady) return;
            // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ –∏–º–µ–Ω–∏
            document.getElementById('profileNameInput').value = document.getElementById('userNameDisplay').innerText === '–¢—Ä–µ–π–¥–µ—Ä' ? '' : document.getElementById('userNameDisplay').innerText;
            
            // –í—ã–¥–µ–ª–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –∞–≤–∞—Ç–∞—Ä–∞
            const currentImgSrc = document.getElementById('avatarImg').src;
            const currentSeed = currentImgSrc.includes('seed=') ? currentImgSrc.split('seed=')[1].split('&')[0] : 'Neko';

            document.querySelectorAll('.avatar-option').forEach(el => {
                el.classList.remove('selected');
                if (el.dataset.seed === currentSeed) {
                    el.classList.add('selected');
                }
            });
            
            document.getElementById('modalFeedback').classList.add('hidden'); // –°–±—Ä–æ—Å —Å–æ–æ–±—â–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö
            document.getElementById('profileModal').classList.remove('hidden');
        }

        window.closeProfileModal = function() {
            document.getElementById('profileModal').classList.add('hidden');
        }
        
        window.saveProfile = async function() {
            if (!isAuthReady || !userId || !db) return;

            const newName = document.getElementById('profileNameInput').value.trim();
            const selectedAvatar = document.querySelector('.avatar-option.selected');
            const newAvatarSeed = selectedAvatar ? selectedAvatar.dataset.seed : 'Neko';

            if (newName.length < 2) {
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º UI –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–µ
                document.getElementById('modalFeedback').textContent = "–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –Ω–µ –º–µ–Ω–µ–µ 2 —Å–∏–º–≤–æ–ª–æ–≤.";
                document.getElementById('modalFeedback').classList.remove('hidden');
                return;
            }
            
            // –ü—É—Ç—å –∫ –¥–æ–∫—É–º–µ–Ω—Ç—É –ø—Ä–æ—Ñ–∏–ª—è
            const userProfileDocRef = doc(db, "artifacts", appId, "users", userId, "data", "profile");
            
            try {
                await updateDoc(userProfileDocRef, {
                    name: newName,
                    avatarSeed: newAvatarSeed
                });

                console.log("Profile updated successfully!");
                document.getElementById('modalFeedback').classList.add('hidden'); 
                closeProfileModal();

            } catch (error) {
                console.error("Error updating profile:", error);
                document.getElementById('modalFeedback').textContent = "–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.";
                document.getElementById('modalFeedback').classList.remove('hidden');
            }
        }

        window.logout = function() {
            // –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã
            signOut(auth).then(() => {
                console.log("User signed out.");
                // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã, —á—Ç–æ–±—ã —Å–∏—Å—Ç–µ–º–∞ Canvas –º–æ–≥–ª–∞ –≤—ã–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω/–∞–Ω–æ–Ω–∏–º–Ω—ã–π –≤—Ö–æ–¥
                window.location.reload(); 
            }).catch((error) => {
                console.error("Error signing out:", error);
            });
        }
        
        // –ù–∞—á–∞–ª—å–Ω—ã–π –≤—ã–∑–æ–≤ –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–µ–ª–µ–∫—Ç–æ—Ä–∞ –∞–≤–∞—Ç–∞—Ä–æ–≤
        document.addEventListener("DOMContentLoaded", () => {
            window.initializeAvatarSelector();
        });
        
    </script>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Press+Start+2P&display=swap" rel="stylesheet">
    
    <style>
        body { 
            font-family: 'Inter', sans-serif; 
            background-color: #050505; 
            color: #ffffff; 
        }
        .font-pixel { font-family: 'Press Start 2P', cursive; }
        .glass { 
            background: rgba(255, 255, 255, 0.05); 
            backdrop-filter: blur(10px); 
            border: 1px solid rgba(255, 255, 255, 0.1); 
        }
        .nav-link { 
            cursor: pointer; 
            padding: 10px 15px; 
            border-radius: 5px; 
            transition: 0.2s; 
            color: #aaa; 
        }
        .nav-link:hover { 
            background: rgba(255,255,255,0.1); 
            color: white; 
        }
        .avatar-option { 
            width: 50px; 
            height: 50px; 
            cursor: pointer; 
            border: 2px solid transparent; 
            transition: border-color 0.2s; 
            border-radius: 50%; 
        }
        .avatar-option.selected { 
            border-color: #f97316; /* –û—Ä–∞–Ω–∂–µ–≤—ã–π –∞–∫—Ü–µ–Ω—Ç */
            box-shadow: 0 0 8px rgba(249, 115, 22, 0.6);
        }
        .modal-enter { animation: fadeIn 0.3s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- NAVIGATION BAR -->
    <nav class="border-b border-gray-800 bg-black/50 backdrop-blur-md sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 md:px-6 h-16 flex items-center justify-between">
            <div class="flex items-center gap-4">
                <div class="w-8 h-8 bg-orange-600 rounded flex items-center justify-center font-pixel text-[10px] text-black">NK</div>
                <div class="hidden md:flex gap-2">
                    <a class="nav-link text-white font-semibold">–û–±–∑–æ—Ä</a>
                    <a class="nav-link">–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏</a>
                    <a class="nav-link">–û–±–º–µ–Ω</a>
                </div>
            </div>
            
            <div class="flex items-center gap-4">
                <!-- ID –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û) -->
                <div class="hidden md:block text-right">
                    <div id="userIdDisplay" class="font-mono text-xs text-gray-500">ID: –ó–∞–≥—Ä—É–∑–∫–∞...</div>
                    <div class="text-[10px] text-gray-500 uppercase tracking-wider">ID –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</div>
                </div>

                <div class="text-right">
                    <div class="text-[10px] text-gray-500 uppercase tracking-wider">–ö–æ—à–µ–ª–µ–∫</div>
                    <div id="walletDisplay" class="font-mono text-xs text-orange-400">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                </div>

                <button onclick="logout()" class="text-gray-500 hover:text-white transition" aria-label="–í—ã—Ö–æ–¥">
                    <!-- –ö–Ω–æ–ø–∫–∞ –≤—ã—Ö–æ–¥–∞ -->
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                    </svg>
                </button>
            </div>
        </div>
    </nav>

    <!-- MAIN CONTENT -->
    <main class="flex-1 max-w-7xl mx-auto w-full p-4 md:p-6 relative z-20">
        
        <!-- Profile Header -->
        <div class="flex items-end mb-10 border-b border-gray-800 pb-6">
            <div class="w-24 h-24 bg-black border-4 border-gray-900 rounded-2xl overflow-hidden shadow-xl relative z-30">
                <img id="avatarImg" class="w-full h-full bg-gray-800" src="https://api.dicebear.com/7.x/identicon/svg?seed=Neko" alt="–ê–≤–∞—Ç–∞—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
            </div>
            <div class="ml-6 mb-2 relative z-30">
                <h1 class="text-3xl font-bold" id="userNameDisplay">–¢—Ä–µ–π–¥–µ—Ä</h1>
                <p class="text-gray-400 text-sm flex items-center gap-2">
                    <span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span> –í —Å–µ—Ç–∏
                </p>
                <!-- –ö–Ω–æ–ø–∫–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è -->
                <button onclick="openProfileModal()" class="text-xs text-orange-500 hover:text-white mt-1 border border-orange-500/50 px-3 py-1 rounded transition">
                    –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
                </button>
            </div>
        </div>

        <!-- KPI Grid (4-Column Layout) -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
            
            <!-- Balance Card (Primary) -->
            <div class="glass p-6 rounded-2xl col-span-2 relative overflow-hidden group border-l-4 border-orange-600 bg-gray-900/50 shadow-lg shadow-black/20">
                <h3 class="text-gray-400 text-sm uppercase tracking-widest mb-2">–û–±—â–∏–π –±–∞–ª–∞–Ω—Å</h3>
                <div class="flex items-baseline gap-2">
                    <span id="balanceDisplay" class="text-4xl font-extrabold text-white">0.0000</span>
                    <span class="text-xl text-orange-500 font-pixel">NEKO</span>
                </div>
                <div class="mt-4 flex flex-wrap gap-4">
                    <!-- –ö–Ω–æ–ø–∫–∞ –≤—ã–≤–æ–¥–∞ -->
                    <a href="withdraw.html" class="bg-orange-600 hover:bg-orange-500 text-black px-4 py-2 rounded-lg font-bold transition shadow-lg shadow-orange-600/30 text-sm">
                        –í—ã–≤–æ–¥
                    </a>
                    <!-- –ö–Ω–æ–ø–∫–∞ –æ–±–º–µ–Ω–∞ -->
                    <button class="bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg font-bold transition text-sm">
                        –û–±–º–µ–Ω
                    </button>
                </div>
            </div>

            <!-- Total Mined Card -->
            <div class="glass p-6 rounded-2xl border border-gray-800">
                <h3 class="text-gray-400 text-sm uppercase tracking-widest mb-1">–í—Å–µ–≥–æ –∑–∞—Ä–∞–±–æ—Ç–∞–Ω–æ</h3>
                <p class="text-2xl font-bold text-green-400" id="totalMinedDisplay">0.00</p>
                <p class="text-xs text-gray-500 mt-2">–ë–∞–ª–∞–Ω—Å –Ω–æ–¥—ã</p>
            </div>

            <!-- Total Withdrawn Card -->
            <div class="glass p-6 rounded-2xl border border-gray-800">
                <h3 class="text-gray-400 text-sm uppercase tracking-widest mb-1">–í—Å–µ–≥–æ –≤—ã–≤–µ–¥–µ–Ω–æ</h3>
                <p class="text-2xl font-bold text-red-400" id="totalWithdrawnDisplay">0.00</p>
                <p class="text-xs text-gray-500 mt-2">–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ –∑–∞—è–≤–∫–∏</p>
            </div>
        </div>

        <!-- Transactions and Donations Grid -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">

            <!-- Total Donated Card -->
            <div class="glass p-6 rounded-2xl border-l-4 border-fuchsia-600">
                <h3 class="text-gray-400 text-sm uppercase tracking-widest mb-1">–ü–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–æ –∫–æ—à–∫–∞–º üòª</h3>
                <p class="text-3xl font-bold text-fuchsia-400" id="totalDonatedDisplay">0.00</p>
                <p class="text-xs text-gray-500 mt-2">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ –≤–∞—à–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π</p>
            </div>

            <!-- Transactions List (Col-span 2) -->
            <div class="glass p-6 rounded-2xl col-span-1 md:col-span-2 border border-gray-700">
                <h3 class="text-gray-300 text-xl font-semibold mb-4 border-b border-gray-800 pb-2">–ü–æ—Å–ª–µ–¥–Ω–∏–µ 5 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π</h3>
                <div class="space-y-3" id="transactionsList">
                    <p class="text-gray-500 text-xs text-center p-2">–ó–∞–≥—Ä—É–∑–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π...</p>
                </div>
            </div>
        </div>
    </main>
    
    <!-- === PROFILE EDIT MODAL === -->
    <div id="profileModal" class="fixed inset-0 z-[100] hidden flex items-center justify-center p-4" onclick="closeProfileModal()">
        <!-- –§–æ–Ω -->
        <div class="absolute inset-0 bg-black/90 backdrop-blur-sm"></div>
        
        <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ -->
        <div id="modalContent" class="glass p-8 rounded-2xl w-full max-w-md mx-auto relative shadow-2xl modal-enter" onclick="event.stopPropagation()">
            
            <div class="text-center mb-6">
                <h3 class="text-2xl font-bold text-white">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</h3>
                <p class="text-gray-400 text-xs mt-2">–ò–º—è –∏ –ê–≤–∞—Ç–∞—Ä</p>
            </div>
            
            <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ/–æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ -->
            <div id="modalFeedback" class="hidden bg-red-800/30 text-red-300 text-sm p-3 rounded mb-4"></div>

            <div class="space-y-6">
                <!-- –í–≤–æ–¥ –∏–º–µ–Ω–∏ -->
                <div>
                    <label class="text-xs text-gray-400 uppercase mb-2 block">–í–∞—à–µ –∏–º—è (–Ω–∏–∫)</label>
                    <input type="text" id="profileNameInput" maxlength="20"
                        class="w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-3 text-white focus:border-orange-500 focus:outline-none text-sm placeholder-gray-600"
                        placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä, CryptoCatLover"
                    >
                </div>

                <!-- –í—ã–±–æ—Ä –ê–≤–∞—Ç–∞—Ä–∞ -->
                <div>
                    <label class="text-xs text-gray-400 uppercase mb-2 block">–í—ã–±–µ—Ä–∏—Ç–µ –ê–≤–∞—Ç–∞—Ä</label>
                    <div id="avatarSelector" class="flex flex-wrap gap-3 justify-center bg-black/30 p-4 rounded-lg">
                        <!-- –ê–≤–∞—Ç–∞—Ä—ã –±—É–¥—É—Ç –≤–Ω–µ–¥—Ä–µ–Ω—ã JS -->
                    </div>
                </div>
                
                <button onclick="saveProfile()" class="w-full bg-orange-600 hover:bg-orange-500 text-black font-bold py-3 rounded-lg transition uppercase tracking-wider text-sm">
                    –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
                </button>
            </div>
            
            <!-- –ö–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è -->
            <button onclick="closeProfileModal()" class="absolute top-4 right-4 text-gray-500 hover:text-white text-xl">‚úï</button>
        </div>
    </div>

</body>
</html>
