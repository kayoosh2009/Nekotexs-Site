<!DOCTYPE html>

<html lang="en">

<head>

<meta charset="UTF-8">

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Nekotexs | Dashboard</title>

<script src="https://cdn.tailwindcss.com"></script>

<!-- Firebase -->

<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>

<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Press+Start+2P&display=swap" rel="stylesheet">

<style>

body { font-family: 'Inter', sans-serif; background-color: #050505; color: #ffffff; }

.font-pixel { font-family: 'Press Start 2P', cursive; }

.glass { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); }

.nav-link { cursor: pointer; padding: 10px 15px; border-radius: 5px; transition: 0.2s; color: #aaa; }

.nav-link:hover { background: rgba(255,255,255,0.1); color: white; }

.avatar-option { width: 50px; height: 50px; cursor: pointer; border: 2px solid transparent; transition: border-color 0.2s; }

.avatar-option.selected { border-color: #ff8c00; }

/* Modal Animation */

.modal-enter { animation: fadeIn 0.3s ease-out forwards; }

@keyframes fadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }

</style>

</head>

<body class="min-h-screen flex flex-col">



<!-- NAVIGATION BAR -->

<nav class="border-b border-gray-800 bg-black/50 backdrop-blur-md sticky top-0 z-50">

<div class="max-w-7xl mx-auto px-6 h-16 flex items-center justify-between">

<div class="flex items-center gap-4">

<div class="w-8 h-8 bg-orange-500 rounded flex items-center justify-center font-pixel text-[10px] text-black">NK</div>

<div class="hidden md:flex gap-2">

<a class="nav-link text-white font-semibold">–û–±–∑–æ—Ä</a>

<a class="nav-link">–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏</a>

<a class="nav-link">–û–±–º–µ–Ω</a>

</div>

</div>

<div class="flex items-center gap-4">

<!-- ADMIN BUTTON (Hidden by default) -->

<a id="adminBtn" href="admin.html" class="hidden bg-red-900/50 text-red-400 border border-red-500/50 px-3 py-1 rounded text-xs font-bold hover:bg-red-900 transition">

–ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨

</a>



<div class="text-right">

<div class="text-[10px] text-gray-500 uppercase tracking-wider">–ö–æ—à–µ–ª–µ–∫</div>

<div id="walletDisplay" class="font-mono text-xs text-orange-500">–ó–∞–≥—Ä—É–∑–∫–∞...</div>

</div>

<button onclick="logout()" class="text-gray-500 hover:text-white transition">

<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">

<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />

</svg>

</button>

</div>

</div>

</nav>



<!-- MAIN CONTENT -->

<main class="flex-1 max-w-7xl mx-auto w-full p-6 relative z-20">

<!-- Profile Header -->

<div class="flex items-end mb-10">

<div class="w-24 h-24 bg-black border-4 border-[#050505] rounded-2xl overflow-hidden shadow-2xl relative z-30">

<img id="avatarImg" class="w-full h-full bg-gray-800" src="https://api.dicebear.com/7.x/identicon/svg?seed=Neko">

</div>

<div class="ml-6 mb-2 relative z-30">

<h1 class="text-3xl font-bold" id="userNameDisplay">–¢—Ä–µ–π–¥–µ—Ä</h1>

<p class="text-gray-400 text-sm flex items-center gap-2">

<span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span> –í —Å–µ—Ç–∏

</p>

<button onclick="openProfileModal()" class="text-xs text-orange-500 hover:text-white mt-1">

–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å

</button>

</div>

</div>



<!-- KPI Grid (Balance + Flow) -->

<div class="grid md:grid-cols-4 gap-6 mb-6">

<!-- Balance Card -->

<div class="glass p-6 rounded-2xl col-span-2 relative overflow-hidden group border-l-4 border-orange-600">

<h3 class="text-gray-400 text-sm uppercase tracking-widest mb-2">–û–±—â–∏–π –±–∞–ª–∞–Ω—Å</h3>

<div class="flex items-baseline gap-2">

<span id="balanceDisplay" class="text-4xl font-bold text-white">0.0000</span>

<span class="text-xl text-orange-500 font-pixel">NEKO</span>

</div>

<div class="mt-4 flex gap-4">

<button onclick="window.location.href='withdraw.html'" class="bg-orange-600 hover:bg-orange-500 text-black px-4 py-2 rounded font-bold transition shadow-lg shadow-orange-600/20 text-sm">

–í—ã–≤–æ–¥

</button>

<button class="bg-gray-800 hover:bg-gray-700 text-white px-4 py-2 rounded font-bold transition text-sm">

–û–±–º–µ–Ω

</button>

</div>

</div>



<!-- Total Mined Card -->

<div class="glass p-6 rounded-2xl">

<h3 class="text-gray-400 text-sm uppercase tracking-widest mb-1">–í—Å–µ–≥–æ –∑–∞—Ä–∞–±–æ—Ç–∞–Ω–æ</h3>

<p class="text-2xl font-bold text-green-400" id="totalMinedDisplay">0.00</p>

<p class="text-xs text-gray-500 mt-2">–ë–∞–ª–∞–Ω—Å –Ω–æ–¥—ã</p>

</div>



<!-- Total Withdrawn Card -->

<div class="glass p-6 rounded-2xl">

<h3 class="text-gray-400 text-sm uppercase tracking-widest mb-1">–í—Å–µ–≥–æ –≤—ã–≤–µ–¥–µ–Ω–æ</h3>

<p class="text-2xl font-bold text-red-400" id="totalWithdrawnDisplay">0.00</p>

<p class="text-xs text-gray-500 mt-2">–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ –∑–∞—è–≤–∫–∏</p>

</div>

</div>



<!-- Secondary Grid (Donations + Node Status) -->

<div class="grid md:grid-cols-3 gap-6">



<!-- Total Donated Card -->

<div class="glass p-6 rounded-2xl border-l-4 border-fuchsia-600">

<h3 class="text-gray-400 text-sm uppercase tracking-widest mb-1">–ü–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–æ –∫–æ—à–∫–∞–º üòª</h3>

<p class="text-3xl font-bold text-fuchsia-400" id="totalDonatedDisplay">0.00</p>

<p class="text-xs text-gray-500 mt-2">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ –≤–∞—à–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π</p>

</div>



<!-- Transactions List -->

<div class="glass p-6 rounded-2xl col-span-2">

<h3 class="text-gray-300 text-sm uppercase tracking-widest mb-4 border-b border-gray-700 pb-2">–ü–æ—Å–ª–µ–¥–Ω–∏–µ 5 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π</h3>

<div class="space-y-3" id="transactionsList">

<p class="text-gray-500 text-xs text-center">–ù–µ—Ç –Ω–µ–¥–∞–≤–Ω–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π.</p>

</div>

</div>

</div>

</main>

<!-- === PROFILE EDIT MODAL === -->

<div id="profileModal" class="fixed inset-0 z-[100] hidden flex items-center justify-center">

<!-- Backdrop -->

<div class="absolute inset-0 bg-black/90 backdrop-blur-sm" onclick="closeProfileModal()"></div>

<!-- Modal Content -->

<div class="relative bg-[#0a0a0a] border border-orange-500/50 p-8 rounded-2xl w-full max-w-md shadow-[0_0_50px_rgba(255,140,0,0.2)] transform transition-all modal-enter mx-4">

<div class="text-center mb-6">

<h3 class="text-2xl font-bold text-white">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</h3>

<p class="text-gray-400 text-xs mt-2">–ò–º—è –∏ –ê–≤–∞—Ç–∞—Ä</p>

</div>

<div class="space-y-6">

<!-- Name Input -->

<div>

<label class="text-xs text-gray-400 uppercase mb-2 block">–í–∞—à–µ –∏–º—è (–Ω–∏–∫)</label>

<input type="text" id="profileNameInput" maxlength="20"

class="w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-3 text-white focus:border-orange-500 focus:outline-none text-sm placeholder-gray-600"

placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä, CryptoCatLover"

>

</div>



<!-- Avatar Selection -->

<div>

<label class="text-xs text-gray-400 uppercase mb-2 block">–í—ã–±–µ—Ä–∏—Ç–µ –ê–≤–∞—Ç–∞—Ä (1-15)</label>

<div id="avatarSelector" class="flex flex-wrap gap-2 justify-center bg-black/30 p-4 rounded-lg">

<!-- Avatars will be injected here by JS -->

</div>

</div>

<button onclick="saveProfile()" class="w-full bg-orange-600 hover:bg-orange-500 text-black font-bold py-3 rounded-lg transition uppercase tracking-wider text-sm">

–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è

</button>

</div>

<!-- Close Button -->

<button onclick="closeProfileModal()" class="absolute top-4 right-4 text-gray-500 hover:text-white text-xl">‚úï</button>

</div>

</div>





<script>

// --- CONFIG ---

const firebaseConfig = {

apiKey: "AIzaSyCNjblbAvTzTveZomoMOH4ZhtuLtg-EEfU",

authDomain: "nekotexs.firebaseapp.com",

databaseURL: "https://nekotexs-default-rtdb.firebaseio.com",

projectId: "nekotexs",

storageBucket: "nekotexs.firebasestorage.app",

messagingSenderId: "596436176972",

appId: "1:596436176972:web:d2870ff374ce52acb9e4e9"

};

firebase.initializeApp(firebaseConfig);

const db = firebase.firestore();

const ADMIN_WALLET = "99LRmqppEMABzsZMYdDqhxqGaLDXZECpFqPBf9dHPdaf";

let currentUserWallet = null;

let selectedAvatarId = 1;

const AVATAR_COUNT = 15; // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∞–≤–∞—Ç–∞—Ä–æ–≤



// --- INIT ---

document.addEventListener("DOMContentLoaded", async () => {

currentUserWallet = localStorage.getItem('neko_wallet');

if (!currentUserWallet) {

window.location.href = "index.html";

return;

}



// 1. Set Basic Info

const shortWallet = currentUserWallet.slice(0, 4) + '...' + currentUserWallet.slice(-4);

document.getElementById('walletDisplay').innerText = shortWallet;

document.getElementById('avatarImg').src = getAvatarPath(1, currentUserWallet); // Default fallback



// 2. Check Admin

if (currentUserWallet === ADMIN_WALLET) {

document.getElementById('adminBtn').classList.remove('hidden');

}



// 3. Setup Firestore Listeners

listenToUserData();

listenToTransactions();

// 4. Initialize Avatar Selector

initializeAvatarSelector();

});

// --- DATA LISTENERS ---



function listenToUserData() {

// –°–ª—É—à–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–±–∞–ª–∞–Ω—Å, –∏–º—è, –∞–≤–∞—Ç–∞—Ä, –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏)

db.collection("users").doc(currentUserWallet).onSnapshot((doc) => {

const data = doc.data();

const bal = data?.balance || 0;

const name = data?.name || "–¢—Ä–µ–π–¥–µ—Ä";

const avatarId = data?.avatarId || 0;

const totalMined = data?.totalMined || 0;

const totalWithdrawn = data?.totalWithdrawn || 0;

const totalDonated = data?.totalDonated || 0;

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –∏ –º–µ—Ç—Ä–∏–∫

document.getElementById('balanceDisplay').innerText = bal.toFixed(4);

document.getElementById('totalMinedDisplay').innerText = totalMined.toFixed(4);

document.getElementById('totalWithdrawnDisplay').innerText = totalWithdrawn.toFixed(4);

document.getElementById('totalDonatedDisplay').innerText = totalDonated.toFixed(4);

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –∏ –∞–≤–∞—Ç–∞—Ä–∞

document.getElementById('userNameDisplay').innerText = name;

document.getElementById('avatarImg').src = getAvatarPath(avatarId, currentUserWallet);

selectedAvatarId = avatarId; // –û–±–Ω–æ–≤–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π ID

});

}

function listenToTransactions() {

// –°–ª—É—à–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

db.collection("transactions")

.where('wallet', '==', currentUserWallet)

.orderBy('timestamp', 'desc')

.limit(5)

.onSnapshot(snapshot => {

const list = document.getElementById('transactionsList');

let html = '';



if (snapshot.empty) {

list.innerHTML = '<p class="text-gray-500 text-xs text-center">–ù–µ—Ç –Ω–µ–¥–∞–≤–Ω–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π.</p>';

return;

}



snapshot.forEach(doc => {

const data = doc.data();

const type = data.type === 'deposit' ? '–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ' : '–í—ã–≤–æ–¥';

const amount = data.amount || 0;

const color = data.type === 'deposit' ? 'text-green-400' : 'text-red-400';

const sign = data.type === 'deposit' ? '+' : '-';

let dateStr = "N/A";

if (data.timestamp && data.timestamp.seconds) {

dateStr = new Date(data.timestamp.seconds * 1000).toLocaleString('ru-RU', {

day: '2-digit', month: 'short', hour: '2-digit', minute: '2-digit'

});

}



html += `

<div class="flex justify-between items-center text-xs p-2 bg-black/30 rounded">

<span class="text-gray-400">${dateStr}</span>

<span class="${color} font-bold">${sign}${amount.toFixed(4)} NEKO</span>

<span class="text-gray-500">${type}</span>

</div>

`;

});



list.innerHTML = html;

});

}

// --- PROFILE LOGIC ---



function getAvatarPath(id, seed) {

// –ò—Å–ø–æ–ª—å–∑—É–µ–º –∑–∞–≥–ª—É—à–∫—É, —Ç–∞–∫ –∫–∞–∫ –Ω–µ—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ img/avatar/*.png

if (id >= 1 && id <= AVATAR_COUNT) {

return `https://placehold.co/50x50/3730a3/ffffff?text=${id}`; // Placeholder for custom avatar

}

// –ê–≤–∞—Ç–∞—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (identicon)

return `https://api.dicebear.com/7.x/identicon/svg?seed=${seed}`;

}

function initializeAvatarSelector() {

const selector = document.getElementById('avatarSelector');

for (let i = 1; i <= AVATAR_COUNT; i++) {

const img = document.createElement('img');

img.src = getAvatarPath(i, currentUserWallet);

img.alt = `Avatar ${i}`;

img.className = 'avatar-option rounded-full';

img.dataset.id = i;

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞

img.onclick = () => {

document.querySelectorAll('.avatar-option').forEach(el => el.classList.remove('selected'));

img.classList.add('selected');

selectedAvatarId = i;

};

selector.appendChild(img);

}

}



function openProfileModal() {

// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–∫—É—â–µ–µ –∏–º—è –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞

document.getElementById('profileNameInput').value = document.getElementById('userNameDisplay').innerText === '–¢—Ä–µ–π–¥–µ—Ä' ? '' : document.getElementById('userNameDisplay').innerText;

// –í—ã–¥–µ–ª—è–µ–º —Ç–µ–∫—É—â–∏–π –≤—ã–±—Ä–∞–Ω–Ω—ã–π –∞–≤–∞—Ç–∞—Ä

document.querySelectorAll('.avatar-option').forEach(el => {

el.classList.remove('selected');

if (parseInt(el.dataset.id) === selectedAvatarId) {

el.classList.add('selected');

}

});

document.getElementById('profileModal').classList.remove('hidden');

}



function closeProfileModal() {

document.getElementById('profileModal').classList.add('hidden');

}

async function saveProfile() {

const newName = document.getElementById('profileNameInput').value.trim();

const newAvatarId = selectedAvatarId;



if (!newName) {

alert("–ò–º—è –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º.");

return;

}

try {

// –û–±–Ω–æ–≤–ª—è–µ–º –∏–º—è –∏ ID –∞–≤–∞—Ç–∞—Ä–∞ –≤ Firestore

await db.collection("users").doc(currentUserWallet).update({

name: newName,

avatarId: newAvatarId

});

closeProfileModal();

} catch (e) {

console.error("Error saving profile:", e);

alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.");

}

}



function logout() {

localStorage.removeItem('neko_wallet');

window.location.href = "index.html";

}

</script>

</body>

</html>
